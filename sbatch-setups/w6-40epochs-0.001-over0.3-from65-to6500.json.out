TestTrain
Settings from ./sbatch-setups/w6-40epochs-0.001-over0.3-from65-to6500.json
[rank: 0] Global seed set to 4222
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Global seed set to 4222
initializing deepspeed distributed: GLOBAL_RANK: 0, MEMBER: 1/1
Missing logger folder: ./lightning_logs/CropOrWeed2_1280px_yolov7-w6max_epochs=40
/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /pfs/data5/home/ma/ma_ma/ma_dsperber/CropAndWeedDetection/models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
loading torch...imported torchimported lightning and albumentations. Importing model framework...
Frameworks
Namespace(settings='./sbatch-setups/w6-40epochs-0.001-over0.3-from65-to6500.json')
{'dataset': {'accumulate_batch_size': 1,
             'batch_size': 16,
             'eval_batch_scale': 2,
             'image_size': [1280, 1280],
             'name': 'CropOrWeed2',
             'num_workers': 19,
             'seed': 4222,
             'stack2_images': True,
             'use_extra_class': 0},
 'loss': {'box_loss_weight': 0.05,
          'cls_loss_weight': 0.5,
          'obj_loss_weight': 1.0,
          'ota_loss': True},
 'lr_onecycle': {'base_momentum': 0.8,
                 'div_factor': 65.0,
                 'final_div_factor': 6500.0,
                 'max_lr': 0.001,
                 'max_momentum': 0.937,
                 'pct_start': 0.3},
 'lr_scheduler': {'milestone_multiplier': 0.1,
                  'milestones': [40, 50],
                  'warmup_epochs': 1,
                  'warmup_multiplier': 0.2},
 'mAP': {'iou_threshold': 0.7,
         'max_detections': 150,
         'min_confidence': 0.02,
         'nms_threshold': 0.02},
 'model': {'freeze': False, 'name': 'yolov7-w6', 'pretrained': True},
 'optimizer': {'learning_rate': 0.001,
               'lr_scheduler': 'OneCycleLR',
               'name': 'SGD',
               'weight_decay': 0.0005},
 'trainer': {'ckpt_path': False,
             'deepspeed_config': {'train_batch_size': 'batch_size',
                                  'train_micro_batch_size_per_gpu': 'batch_size',
                                  'zero_allow_untested_optimizer': True,
                                  'zero_force_ds_cpu_optimizer': False,
                                  'zero_optimization': {'allgather_bucket_size': 500000000.0,
                                                        'offload_optimizer': {'device': 'cpu',
                                                                              'pin_memory': True},
                                                        'reduce_bucket_size': 500000000.0,
                                                        'stage': 2}},
             'max_epochs': 40,
             'precision': '16-mixed',
             'strategy': 'auto'}}
Using Deepseed True batch size 16



Using customized paths: {'bboxes': '/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/data/', 'images': '/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/data/'}
...Data Module initialized
Transferred 646/668 items from https://github.com/Chris-hughes10/Yolov7-training/releases/download/0.1.0/yolov7-w6_training_state_dict.pt
Data paths already exists. Skipping download and mask generation. No integrity check was performed.
BBoxes cached in 1e+01 s
BBoxes cached in 0.4 s
model type torch.float32
Using OneCycleLR scheduler
[2023-04-08 00:33:56,366] [WARNING] [engine.py:1214:_do_optimizer_sanity_check] **** You are using ZeRO with an untested optimizer, proceed with caution *****
Using /pfs/data5/home/ma/ma_ma/ma_dsperber/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
Emitting ninja build file /pfs/data5/home/ma/ma_ma/ma_dsperber/.cache/torch_extensions/py39_cu117/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Using /pfs/data5/home/ma/ma_ma/ma_dsperber/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
No modifications detected for re-loaded extension module utils, skipping build step...
Loading extension module utils...

  | Name     | Type                 | Params | In sizes           | Out sizes                                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0 | model    | Yolov7Model          | 81.0 M | [1, 3, 1280, 1280] | [[1, 3, 160, 160, 7], [1, 3, 80, 80, 7], [1, 3, 40, 40, 7], [1, 3, 20, 20, 7], [1, 3, 160, 160, 7], [1, 3, 80, 80, 7], [1, 3, 40, 40, 7], [1, 3, 20, 20, 7]]
1 | mAP      | MeanAveragePrecision | 0      | ?                  | ?                                                                                                                                                           
2 | test_mAP | MeanAveragePrecision | 0      | ?                  | ?                                                                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
81.0 M    Trainable params
0         Non-trainable params
81.0 M    Total params
323.847   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Time to load utils op: 0.345991849899292 seconds
Rank: 0 partition count [1, 1] and sizes[(73084, False), (80888704, False)] 
Time to load utils op: 0.0010647773742675781 seconds
Fitting yolov7-w6 on CropOrWeed2
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|█████     | 1/2 [00:00<00:00,  1.47it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:03<00:00,  1.74s/it]/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: UserWarning: You called `self.log('map_50', ...)` in your `on_validation_epoch_end` but the value needs to be floating point. Converting it to torch.float32.
  warning_cache.warn(
/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: UserWarning: You called `self.log('map_75', ...)` in your `on_validation_epoch_end` but the value needs to be floating point. Converting it to torch.float32.
  warning_cache.warn(
                                                                           Training: 0it [00:00, ?it/s]Training:   0%|          | 0/338 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/338 [00:00<?, ?it/s] Epoch 0:   0%|          | 1/338 [00:15<1:29:25, 15.92s/it]Epoch 0:   0%|          | 1/338 [00:15<1:29:25, 15.92s/it, v_num=0, train_loss=224.0]Epoch 0:   1%|          | 2/338 [00:17<50:14,  8.97s/it, v_num=0, train_loss=224.0]  Epoch 0:   1%|          | 2/338 [00:17<50:15,  8.97s/it, v_num=0, train_loss=225.0]Epoch 0:   1%|          | 3/338 [00:20<37:20,  6.69s/it, v_num=0, train_loss=225.0]Epoch 0:   1%|          | 3/338 [00:20<37:20,  6.69s/it, v_num=0, train_loss=225.0]Epoch 0:   1%|          | 4/338 [00:21<30:32,  5.49s/it, v_num=0, train_loss=225.0]Epoch 0:   1%|          | 4/338 [00:21<30:32,  5.49s/it, v_num=0, train_loss=224.0]Epoch 0:   1%|▏         | 5/338 [00:23<26:13,  4.72s/it, v_num=0, train_loss=224.0]Epoch 0:   1%|▏         | 5/338 [00:23<26:13,  4.72s/it, v_num=0, train_loss=224.0]Epoch 0:   2%|▏         | 6/338 [00:25<23:22,  4.23s/it, v_num=0, train_loss=224.0]Epoch 0:   2%|▏         | 6/338 [00:25<23:22,  4.23s/it, v_num=0, train_loss=224.0]Epoch 0:   2%|▏         | 7/338 [00:26<20:56,  3.80s/it, v_num=0, train_loss=224.0]Epoch 0:   2%|▏         | 7/338 [00:26<20:56,  3.80s/it, v_num=0, train_loss=224.0]Epoch 0:   2%|▏         | 8/338 [00:27<18:57,  3.45s/it, v_num=0, train_loss=224.0]Epoch 0:   2%|▏         | 8/338 [00:27<18:57,  3.45s/it, v_num=0, train_loss=225.0]Epoch 0:   3%|▎         | 9/338 [00:28<17:26,  3.18s/it, v_num=0, train_loss=225.0]Epoch 0:   3%|▎         | 9/338 [00:28<17:26,  3.18s/it, v_num=0, train_loss=224.0]Epoch 0:   3%|▎         | 10/338 [00:30<16:42,  3.06s/it, v_num=0, train_loss=224.0]Epoch 0:   3%|▎         | 10/338 [00:30<16:42,  3.06s/it, v_num=0, train_loss=224.0]Epoch 0:   3%|▎         | 11/338 [00:31<15:39,  2.87s/it, v_num=0, train_loss=224.0]Epoch 0:   3%|▎         | 11/338 [00:31<15:39,  2.87s/it, v_num=0, train_loss=223.0]Epoch 0:   4%|▎         | 12/338 [00:33<15:04,  2.77s/it, v_num=0, train_loss=223.0]Epoch 0:   4%|▎         | 12/338 [00:33<15:04,  2.77s/it, v_num=0, train_loss=224.0]Epoch 0:   4%|▍         | 13/338 [00:34<14:31,  2.68s/it, v_num=0, train_loss=224.0]Epoch 0:   4%|▍         | 13/338 [00:34<14:31,  2.68s/it, v_num=0, train_loss=222.0]Epoch 0:   4%|▍         | 14/338 [00:35<13:50,  2.56s/it, v_num=0, train_loss=222.0]Epoch 0:   4%|▍         | 14/338 [00:35<13:50,  2.56s/it, v_num=0, train_loss=221.0]Epoch 0:   4%|▍         | 15/338 [00:37<13:28,  2.50s/it, v_num=0, train_loss=221.0]Epoch 0:   4%|▍         | 15/338 [00:37<13:28,  2.50s/it, v_num=0, train_loss=221.0]Epoch 0:   5%|▍         | 16/338 [00:39<13:09,  2.45s/it, v_num=0, train_loss=221.0]Epoch 0:   5%|▍         | 16/338 [00:39<13:09,  2.45s/it, v_num=0, train_loss=220.0]Epoch 0:   5%|▌         | 17/338 [00:40<12:50,  2.40s/it, v_num=0, train_loss=220.0]Epoch 0:   5%|▌         | 17/338 [00:40<12:50,  2.40s/it, v_num=0, train_loss=219.0]Epoch 0:   5%|▌         | 18/338 [00:42<12:34,  2.36s/it, v_num=0, train_loss=219.0]Epoch 0:   5%|▌         | 18/338 [00:42<12:34,  2.36s/it, v_num=0, train_loss=217.0]Epoch 0:   6%|▌         | 19/338 [00:44<12:18,  2.32s/it, v_num=0, train_loss=217.0]Epoch 0:   6%|▌         | 19/338 [00:44<12:18,  2.32s/it, v_num=0, train_loss=217.0]Epoch 0:   6%|▌         | 20/338 [00:45<12:04,  2.28s/it, v_num=0, train_loss=217.0]Epoch 0:   6%|▌         | 20/338 [00:45<12:04,  2.28s/it, v_num=0, train_loss=214.0]Epoch 0:   6%|▌         | 21/338 [00:46<11:43,  2.22s/it, v_num=0, train_loss=214.0]Epoch 0:   6%|▌         | 21/338 [00:46<11:43,  2.22s/it, v_num=0, train_loss=inf.0]Epoch 0:   7%|▋         | 22/338 [00:48<11:35,  2.20s/it, v_num=0, train_loss=inf.0]Epoch 0:   7%|▋         | 22/338 [00:48<11:35,  2.20s/it, v_num=0, train_loss=213.0]Epoch 0:   7%|▋         | 23/338 [00:50<11:26,  2.18s/it, v_num=0, train_loss=213.0]Epoch 0:   7%|▋         | 23/338 [00:50<11:26,  2.18s/it, v_num=0, train_loss=212.0]Epoch 0:   7%|▋         | 24/338 [00:51<11:08,  2.13s/it, v_num=0, train_loss=212.0]Epoch 0:   7%|▋         | 24/338 [00:51<11:08,  2.13s/it, v_num=0, train_loss=210.0]Epoch 0:   7%|▋         | 25/338 [00:52<10:52,  2.09s/it, v_num=0, train_loss=210.0]Epoch 0:   7%|▋         | 25/338 [00:52<10:52,  2.09s/it, v_num=0, train_loss=210.0]Epoch 0:   8%|▊         | 26/338 [00:53<10:44,  2.07s/it, v_num=0, train_loss=210.0]Epoch 0:   8%|▊         | 26/338 [00:53<10:44,  2.07s/it, v_num=0, train_loss=209.0]Epoch 0:   8%|▊         | 27/338 [00:55<10:37,  2.05s/it, v_num=0, train_loss=209.0]Epoch 0:   8%|▊         | 27/338 [00:55<10:37,  2.05s/it, v_num=0, train_loss=208.0]Epoch 0:   8%|▊         | 28/338 [00:56<10:24,  2.01s/it, v_num=0, train_loss=208.0]Epoch 0:   8%|▊         | 28/338 [00:56<10:24,  2.01s/it, v_num=0, train_loss=206.0]Epoch 0:   9%|▊         | 29/338 [00:58<10:18,  2.00s/it, v_num=0, train_loss=206.0]Epoch 0:   9%|▊         | 29/338 [00:58<10:18,  2.00s/it, v_num=0, train_loss=207.0]Epoch 0:   9%|▉         | 30/338 [00:59<10:12,  1.99s/it, v_num=0, train_loss=207.0]Epoch 0:   9%|▉         | 30/338 [00:59<10:12,  1.99s/it, v_num=0, train_loss=205.0]Epoch 0:   9%|▉         | 31/338 [01:01<10:06,  1.98s/it, v_num=0, train_loss=205.0]Epoch 0:   9%|▉         | 31/338 [01:01<10:06,  1.98s/it, v_num=0, train_loss=203.0]Epoch 0:   9%|▉         | 32/338 [01:02<10:00,  1.96s/it, v_num=0, train_loss=203.0]Epoch 0:   9%|▉         | 32/338 [01:02<10:00,  1.96s/it, v_num=0, train_loss=202.0]Epoch 0:  10%|▉         | 33/338 [01:03<09:49,  1.93s/it, v_num=0, train_loss=202.0]Epoch 0:  10%|▉         | 33/338 [01:03<09:49,  1.93s/it, v_num=0, train_loss=200.0]Epoch 0:  10%|█         | 34/338 [01:05<09:45,  1.93s/it, v_num=0, train_loss=200.0]Epoch 0:  10%|█         | 34/338 [01:05<09:45,  1.93s/it, v_num=0, train_loss=200.0]Epoch 0:  10%|█         | 35/338 [01:07<09:40,  1.92s/it, v_num=0, train_loss=200.0]Epoch 0:  10%|█         | 35/338 [01:07<09:40,  1.92s/it, v_num=0, train_loss=199.0]Epoch 0:  11%|█         | 36/338 [01:08<09:36,  1.91s/it, v_num=0, train_loss=199.0]Epoch 0:  11%|█         | 36/338 [01:08<09:36,  1.91s/it, v_num=0, train_loss=198.0]Epoch 0:  11%|█         | 37/338 [01:10<09:31,  1.90s/it, v_num=0, train_loss=198.0]Epoch 0:  11%|█         | 37/338 [01:10<09:31,  1.90s/it, v_num=0, train_loss=196.0]Epoch 0:  11%|█         | 38/338 [01:11<09:26,  1.89s/it, v_num=0, train_loss=196.0]Epoch 0:  11%|█         | 38/338 [01:11<09:26,  1.89s/it, v_num=0, train_loss=195.0]Epoch 0:  12%|█▏        | 39/338 [01:13<09:22,  1.88s/it, v_num=0, train_loss=195.0]Epoch 0:  12%|█▏        | 39/338 [01:13<09:22,  1.88s/it, v_num=0, train_loss=193.0]Epoch 0:  12%|█▏        | 40/338 [01:14<09:18,  1.87s/it, v_num=0, train_loss=193.0]Epoch 0:  12%|█▏        | 40/338 [01:14<09:18,  1.87s/it, v_num=0, train_loss=193.0]Epoch 0:  12%|█▏        | 41/338 [01:16<09:14,  1.87s/it, v_num=0, train_loss=193.0]Epoch 0:  12%|█▏        | 41/338 [01:16<09:14,  1.87s/it, v_num=0, train_loss=191.0]Epoch 0:  12%|█▏        | 42/338 [01:18<09:11,  1.86s/it, v_num=0, train_loss=191.0]Epoch 0:  12%|█▏        | 42/338 [01:18<09:11,  1.86s/it, v_num=0, train_loss=190.0]Epoch 0:  13%|█▎        | 43/338 [01:19<09:03,  1.84s/it, v_num=0, train_loss=190.0]Epoch 0:  13%|█▎        | 43/338 [01:19<09:03,  1.84s/it, v_num=0, train_loss=inf.0]Epoch 0:  13%|█▎        | 44/338 [01:20<08:59,  1.84s/it, v_num=0, train_loss=inf.0]Epoch 0:  13%|█▎        | 44/338 [01:20<08:59,  1.84s/it, v_num=0, train_loss=188.0]Epoch 0:  13%|█▎        | 45/338 [01:22<08:56,  1.83s/it, v_num=0, train_loss=188.0]Epoch 0:  13%|█▎        | 45/338 [01:22<08:56,  1.83s/it, v_num=0, train_loss=188.0]Epoch 0:  14%|█▎        | 46/338 [01:23<08:53,  1.83s/it, v_num=0, train_loss=188.0]Epoch 0:  14%|█▎        | 46/338 [01:23<08:53,  1.83s/it, v_num=0, train_loss=186.0]Epoch 0:  14%|█▍        | 47/338 [01:25<08:50,  1.82s/it, v_num=0, train_loss=186.0]Epoch 0:  14%|█▍        | 47/338 [01:25<08:50,  1.82s/it, v_num=0, train_loss=185.0]Epoch 0:  14%|█▍        | 48/338 [01:27<08:46,  1.82s/it, v_num=0, train_loss=185.0]Epoch 0:  14%|█▍        | 48/338 [01:27<08:46,  1.82s/it, v_num=0, train_loss=183.0]Epoch 0:  14%|█▍        | 49/338 [01:28<08:43,  1.81s/it, v_num=0, train_loss=183.0]Epoch 0:  14%|█▍        | 49/338 [01:28<08:43,  1.81s/it, v_num=0, train_loss=182.0]Epoch 0:  15%|█▍        | 50/338 [01:30<08:40,  1.81s/it, v_num=0, train_loss=182.0]Epoch 0:  15%|█▍        | 50/338 [01:30<08:40,  1.81s/it, v_num=0, train_loss=180.0]Epoch 0:  15%|█▌        | 51/338 [01:31<08:37,  1.80s/it, v_num=0, train_loss=180.0]Epoch 0:  15%|█▌        | 51/338 [01:31<08:37,  1.80s/it, v_num=0, train_loss=179.0]Epoch 0:  15%|█▌        | 52/338 [01:32<08:31,  1.79s/it, v_num=0, train_loss=179.0]Epoch 0:  15%|█▌        | 52/338 [01:32<08:31,  1.79s/it, v_num=0, train_loss=177.0]Epoch 0:  16%|█▌        | 53/338 [01:33<08:25,  1.77s/it, v_num=0, train_loss=177.0]Epoch 0:  16%|█▌        | 53/338 [01:33<08:25,  1.77s/it, v_num=0, train_loss=177.0]Epoch 0:  16%|█▌        | 54/338 [01:35<08:22,  1.77s/it, v_num=0, train_loss=177.0]Epoch 0:  16%|█▌        | 54/338 [01:35<08:22,  1.77s/it, v_num=0, train_loss=177.0]Epoch 0:  16%|█▋        | 55/338 [01:37<08:20,  1.77s/it, v_num=0, train_loss=177.0]Epoch 0:  16%|█▋        | 55/338 [01:37<08:20,  1.77s/it, v_num=0, train_loss=176.0]Epoch 0:  17%|█▋        | 56/338 [01:38<08:17,  1.76s/it, v_num=0, train_loss=176.0]Epoch 0:  17%|█▋        | 56/338 [01:38<08:17,  1.76s/it, v_num=0, train_loss=173.0]Epoch 0:  17%|█▋        | 57/338 [01:40<08:14,  1.76s/it, v_num=0, train_loss=173.0]Epoch 0:  17%|█▋        | 57/338 [01:40<08:14,  1.76s/it, v_num=0, train_loss=171.0]Epoch 0:  17%|█▋        | 58/338 [01:41<08:12,  1.76s/it, v_num=0, train_loss=171.0]Epoch 0:  17%|█▋        | 58/338 [01:41<08:12,  1.76s/it, v_num=0, train_loss=170.0]Epoch 0:  17%|█▋        | 59/338 [01:43<08:09,  1.75s/it, v_num=0, train_loss=170.0]Epoch 0:  17%|█▋        | 59/338 [01:43<08:09,  1.75s/it, v_num=0, train_loss=167.0]Epoch 0:  18%|█▊        | 60/338 [01:45<08:07,  1.75s/it, v_num=0, train_loss=167.0]Epoch 0:  18%|█▊        | 60/338 [01:45<08:07,  1.75s/it, v_num=0, train_loss=165.0]Epoch 0:  18%|█▊        | 61/338 [01:46<08:04,  1.75s/it, v_num=0, train_loss=165.0]Epoch 0:  18%|█▊        | 61/338 [01:46<08:04,  1.75s/it, v_num=0, train_loss=162.0]Epoch 0:  18%|█▊        | 62/338 [01:48<08:02,  1.75s/it, v_num=0, train_loss=162.0]Epoch 0:  18%|█▊        | 62/338 [01:48<08:02,  1.75s/it, v_num=0, train_loss=160.0]Epoch 0:  19%|█▊        | 63/338 [01:49<07:59,  1.74s/it, v_num=0, train_loss=160.0]Epoch 0:  19%|█▊        | 63/338 [01:49<07:59,  1.74s/it, v_num=0, train_loss=157.0]Epoch 0:  19%|█▉        | 64/338 [01:51<07:57,  1.74s/it, v_num=0, train_loss=157.0]Epoch 0:  19%|█▉        | 64/338 [01:51<07:57,  1.74s/it, v_num=0, train_loss=155.0]Epoch 0:  19%|█▉        | 65/338 [01:53<07:55,  1.74s/it, v_num=0, train_loss=155.0]Epoch 0:  19%|█▉        | 65/338 [01:53<07:55,  1.74s/it, v_num=0, train_loss=152.0]Epoch 0:  20%|█▉        | 66/338 [01:54<07:52,  1.74s/it, v_num=0, train_loss=152.0]Epoch 0:  20%|█▉        | 66/338 [01:54<07:52,  1.74s/it, v_num=0, train_loss=149.0]Epoch 0:  20%|█▉        | 67/338 [01:56<07:50,  1.73s/it, v_num=0, train_loss=149.0]Epoch 0:  20%|█▉        | 67/338 [01:56<07:50,  1.73s/it, v_num=0, train_loss=146.0]Epoch 0:  20%|██        | 68/338 [01:57<07:47,  1.73s/it, v_num=0, train_loss=146.0]Epoch 0:  20%|██        | 68/338 [01:57<07:47,  1.73s/it, v_num=0, train_loss=142.0]Epoch 0:  20%|██        | 69/338 [01:59<07:45,  1.73s/it, v_num=0, train_loss=142.0]Epoch 0:  20%|██        | 69/338 [01:59<07:45,  1.73s/it, v_num=0, train_loss=139.0]Epoch 0:  21%|██        | 70/338 [02:01<07:43,  1.73s/it, v_num=0, train_loss=139.0]Epoch 0:  21%|██        | 70/338 [02:01<07:43,  1.73s/it, v_num=0, train_loss=136.0]Epoch 0:  21%|██        | 71/338 [02:02<07:41,  1.73s/it, v_num=0, train_loss=136.0]Epoch 0:  21%|██        | 71/338 [02:02<07:41,  1.73s/it, v_num=0, train_loss=133.0]Epoch 0:  21%|██▏       | 72/338 [02:04<07:38,  1.73s/it, v_num=0, train_loss=133.0]Epoch 0:  21%|██▏       | 72/338 [02:04<07:38,  1.73s/it, v_num=0, train_loss=130.0]Epoch 0:  22%|██▏       | 73/338 [02:05<07:36,  1.72s/it, v_num=0, train_loss=130.0]Epoch 0:  22%|██▏       | 73/338 [02:05<07:36,  1.72s/it, v_num=0, train_loss=127.0]Epoch 0:  22%|██▏       | 74/338 [02:07<07:34,  1.72s/it, v_num=0, train_loss=127.0]Epoch 0:  22%|██▏       | 74/338 [02:07<07:34,  1.72s/it, v_num=0, train_loss=123.0]Epoch 0:  22%|██▏       | 75/338 [02:08<07:32,  1.72s/it, v_num=0, train_loss=123.0]Epoch 0:  22%|██▏       | 75/338 [02:08<07:32,  1.72s/it, v_num=0, train_loss=120.0]Epoch 0:  22%|██▏       | 76/338 [02:10<07:30,  1.72s/it, v_num=0, train_loss=120.0]Epoch 0:  22%|██▏       | 76/338 [02:10<07:30,  1.72s/it, v_num=0, train_loss=117.0]Epoch 0:  23%|██▎       | 77/338 [02:12<07:28,  1.72s/it, v_num=0, train_loss=117.0]Epoch 0:  23%|██▎       | 77/338 [02:12<07:28,  1.72s/it, v_num=0, train_loss=113.0]Epoch 0:  23%|██▎       | 78/338 [02:13<07:26,  1.72s/it, v_num=0, train_loss=113.0]Epoch 0:  23%|██▎       | 78/338 [02:13<07:26,  1.72s/it, v_num=0, train_loss=110.0]Epoch 0:  23%|██▎       | 79/338 [02:14<07:22,  1.71s/it, v_num=0, train_loss=110.0]Epoch 0:  23%|██▎       | 79/338 [02:14<07:22,  1.71s/it, v_num=0, train_loss=inf.0]Epoch 0:  24%|██▎       | 80/338 [02:16<07:19,  1.70s/it, v_num=0, train_loss=inf.0]Epoch 0:  24%|██▎       | 80/338 [02:16<07:19,  1.70s/it, v_num=0, train_loss=105.0]Epoch 0:  24%|██▍       | 81/338 [02:18<07:18,  1.71s/it, v_num=0, train_loss=105.0]Epoch 0:  24%|██▍       | 81/338 [02:18<07:18,  1.71s/it, v_num=0, train_loss=102.0]Epoch 0:  24%|██▍       | 82/338 [02:19<07:16,  1.71s/it, v_num=0, train_loss=102.0]Epoch 0:  24%|██▍       | 82/338 [02:19<07:16,  1.71s/it, v_num=0, train_loss=98.40]Epoch 0:  25%|██▍       | 83/338 [02:21<07:14,  1.70s/it, v_num=0, train_loss=98.40]Epoch 0:  25%|██▍       | 83/338 [02:21<07:14,  1.70s/it, v_num=0, train_loss=94.20]Epoch 0:  25%|██▍       | 84/338 [02:23<07:12,  1.70s/it, v_num=0, train_loss=94.20]Epoch 0:  25%|██▍       | 84/338 [02:23<07:12,  1.70s/it, v_num=0, train_loss=90.50]Epoch 0:  25%|██▌       | 85/338 [02:24<07:10,  1.70s/it, v_num=0, train_loss=90.50]Epoch 0:  25%|██▌       | 85/338 [02:24<07:10,  1.70s/it, v_num=0, train_loss=86.90]Epoch 0:  25%|██▌       | 86/338 [02:26<07:08,  1.70s/it, v_num=0, train_loss=86.90]Epoch 0:  25%|██▌       | 86/338 [02:26<07:08,  1.70s/it, v_num=0, train_loss=84.60]Epoch 0:  26%|██▌       | 87/338 [02:27<07:06,  1.70s/it, v_num=0, train_loss=84.60]Epoch 0:  26%|██▌       | 87/338 [02:27<07:06,  1.70s/it, v_num=0, train_loss=81.10]Epoch 0:  26%|██▌       | 88/338 [02:29<07:04,  1.70s/it, v_num=0, train_loss=81.10]Epoch 0:  26%|██▌       | 88/338 [02:29<07:04,  1.70s/it, v_num=0, train_loss=77.30]Epoch 0:  26%|██▋       | 89/338 [02:30<07:02,  1.70s/it, v_num=0, train_loss=77.30]Epoch 0:  26%|██▋       | 89/338 [02:30<07:02,  1.70s/it, v_num=0, train_loss=74.50]Epoch 0:  27%|██▋       | 90/338 [02:32<07:00,  1.70s/it, v_num=0, train_loss=74.50]Epoch 0:  27%|██▋       | 90/338 [02:32<07:00,  1.70s/it, v_num=0, train_loss=71.80]Epoch 0:  27%|██▋       | 91/338 [02:34<06:58,  1.69s/it, v_num=0, train_loss=71.80]Epoch 0:  27%|██▋       | 91/338 [02:34<06:58,  1.69s/it, v_num=0, train_loss=69.40]Epoch 0:  27%|██▋       | 92/338 [02:35<06:56,  1.69s/it, v_num=0, train_loss=69.40]Epoch 0:  27%|██▋       | 92/338 [02:35<06:56,  1.69s/it, v_num=0, train_loss=67.10]Epoch 0:  28%|██▊       | 93/338 [02:37<06:54,  1.69s/it, v_num=0, train_loss=67.10]Epoch 0:  28%|██▊       | 93/338 [02:37<06:54,  1.69s/it, v_num=0, train_loss=65.10]Epoch 0:  28%|██▊       | 94/338 [02:38<06:52,  1.69s/it, v_num=0, train_loss=65.10]Epoch 0:  28%|██▊       | 94/338 [02:38<06:52,  1.69s/it, v_num=0, train_loss=63.20]Epoch 0:  28%|██▊       | 95/338 [02:40<06:50,  1.69s/it, v_num=0, train_loss=63.20]Epoch 0:  28%|██▊       | 95/338 [02:40<06:50,  1.69s/it, v_num=0, train_loss=61.70]Epoch 0:  28%|██▊       | 96/338 [02:41<06:48,  1.69s/it, v_num=0, train_loss=61.70]Epoch 0:  28%|██▊       | 96/338 [02:41<06:48,  1.69s/it, v_num=0, train_loss=60.20]Epoch 0:  29%|██▊       | 97/338 [02:43<06:46,  1.69s/it, v_num=0, train_loss=60.20]Epoch 0:  29%|██▊       | 97/338 [02:43<06:46,  1.69s/it, v_num=0, train_loss=59.00]Epoch 0:  29%|██▉       | 98/338 [02:45<06:44,  1.68s/it, v_num=0, train_loss=59.00]Epoch 0:  29%|██▉       | 98/338 [02:45<06:44,  1.68s/it, v_num=0, train_loss=58.30]Epoch 0:  29%|██▉       | 99/338 [02:46<06:42,  1.68s/it, v_num=0, train_loss=58.30]Epoch 0:  29%|██▉       | 99/338 [02:46<06:42,  1.68s/it, v_num=0, train_loss=57.00]Epoch 0:  30%|██▉       | 100/338 [02:48<06:40,  1.68s/it, v_num=0, train_loss=57.00]Epoch 0:  30%|██▉       | 100/338 [02:48<06:40,  1.68s/it, v_num=0, train_loss=57.20]Epoch 0:  30%|██▉       | 101/338 [02:49<06:38,  1.68s/it, v_num=0, train_loss=57.20]Epoch 0:  30%|██▉       | 101/338 [02:49<06:38,  1.68s/it, v_num=0, train_loss=56.20]Epoch 0:  30%|███       | 102/338 [02:51<06:36,  1.68s/it, v_num=0, train_loss=56.20]Epoch 0:  30%|███       | 102/338 [02:51<06:36,  1.68s/it, v_num=0, train_loss=54.50]Epoch 0:  30%|███       | 103/338 [02:53<06:34,  1.68s/it, v_num=0, train_loss=54.50]Epoch 0:  30%|███       | 103/338 [02:53<06:34,  1.68s/it, v_num=0, train_loss=54.00]Epoch 0:  31%|███       | 104/338 [02:54<06:31,  1.67s/it, v_num=0, train_loss=54.00]Epoch 0:  31%|███       | 104/338 [02:54<06:31,  1.67s/it, v_num=0, train_loss=53.50]Epoch 0:  31%|███       | 105/338 [02:55<06:29,  1.67s/it, v_num=0, train_loss=53.50]Epoch 0:  31%|███       | 105/338 [02:55<06:29,  1.67s/it, v_num=0, train_loss=53.80]Epoch 0:  31%|███▏      | 106/338 [02:57<06:27,  1.67s/it, v_num=0, train_loss=53.80]Epoch 0:  31%|███▏      | 106/338 [02:57<06:27,  1.67s/it, v_num=0, train_loss=53.10]Epoch 0:  32%|███▏      | 107/338 [02:58<06:25,  1.67s/it, v_num=0, train_loss=53.10]Epoch 0:  32%|███▏      | 107/338 [02:58<06:25,  1.67s/it, v_num=0, train_loss=53.20]Epoch 0:  32%|███▏      | 108/338 [03:00<06:24,  1.67s/it, v_num=0, train_loss=53.20]Epoch 0:  32%|███▏      | 108/338 [03:00<06:24,  1.67s/it, v_num=0, train_loss=52.20]Epoch 0:  32%|███▏      | 109/338 [03:02<06:22,  1.67s/it, v_num=0, train_loss=52.20]Epoch 0:  32%|███▏      | 109/338 [03:02<06:22,  1.67s/it, v_num=0, train_loss=52.30]Epoch 0:  33%|███▎      | 110/338 [03:03<06:20,  1.67s/it, v_num=0, train_loss=52.30]Epoch 0:  33%|███▎      | 110/338 [03:03<06:20,  1.67s/it, v_num=0, train_loss=51.80]Epoch 0:  33%|███▎      | 111/338 [03:05<06:18,  1.67s/it, v_num=0, train_loss=51.80]Epoch 0:  33%|███▎      | 111/338 [03:05<06:18,  1.67s/it, v_num=0, train_loss=51.40]Epoch 0:  33%|███▎      | 112/338 [03:06<06:16,  1.67s/it, v_num=0, train_loss=51.40]Epoch 0:  33%|███▎      | 112/338 [03:06<06:16,  1.67s/it, v_num=0, train_loss=51.10]Epoch 0:  33%|███▎      | 113/338 [03:08<06:15,  1.67s/it, v_num=0, train_loss=51.10]Epoch 0:  33%|███▎      | 113/338 [03:08<06:15,  1.67s/it, v_num=0, train_loss=51.40]Epoch 0:  34%|███▎      | 114/338 [03:09<06:13,  1.67s/it, v_num=0, train_loss=51.40]Epoch 0:  34%|███▎      | 114/338 [03:09<06:13,  1.67s/it, v_num=0, train_loss=51.80]Epoch 0:  34%|███▍      | 115/338 [03:11<06:11,  1.67s/it, v_num=0, train_loss=51.80]Epoch 0:  34%|███▍      | 115/338 [03:11<06:11,  1.67s/it, v_num=0, train_loss=50.60]Epoch 0:  34%|███▍      | 116/338 [03:13<06:09,  1.67s/it, v_num=0, train_loss=50.60]Epoch 0:  34%|███▍      | 116/338 [03:13<06:09,  1.67s/it, v_num=0, train_loss=50.60]Epoch 0:  35%|███▍      | 117/338 [03:14<06:07,  1.66s/it, v_num=0, train_loss=50.60]Epoch 0:  35%|███▍      | 117/338 [03:14<06:07,  1.66s/it, v_num=0, train_loss=51.40]Epoch 0:  35%|███▍      | 118/338 [03:16<06:05,  1.66s/it, v_num=0, train_loss=51.40]Epoch 0:  35%|███▍      | 118/338 [03:16<06:05,  1.66s/it, v_num=0, train_loss=50.10]Epoch 0:  35%|███▌      | 119/338 [03:17<06:04,  1.66s/it, v_num=0, train_loss=50.10]Epoch 0:  35%|███▌      | 119/338 [03:17<06:04,  1.66s/it, v_num=0, train_loss=51.00]Epoch 0:  36%|███▌      | 120/338 [03:19<06:02,  1.66s/it, v_num=0, train_loss=51.00]Epoch 0:  36%|███▌      | 120/338 [03:19<06:02,  1.66s/it, v_num=0, train_loss=49.90]Epoch 0:  36%|███▌      | 121/338 [03:21<06:00,  1.66s/it, v_num=0, train_loss=49.90]Epoch 0:  36%|███▌      | 121/338 [03:21<06:00,  1.66s/it, v_num=0, train_loss=49.60]Epoch 0:  36%|███▌      | 122/338 [03:22<05:58,  1.66s/it, v_num=0, train_loss=49.60]Epoch 0:  36%|███▌      | 122/338 [03:22<05:58,  1.66s/it, v_num=0, train_loss=49.60]Epoch 0:  36%|███▋      | 123/338 [03:24<05:56,  1.66s/it, v_num=0, train_loss=49.60]Epoch 0:  36%|███▋      | 123/338 [03:24<05:56,  1.66s/it, v_num=0, train_loss=50.30]Epoch 0:  37%|███▋      | 124/338 [03:25<05:55,  1.66s/it, v_num=0, train_loss=50.30]Epoch 0:  37%|███▋      | 124/338 [03:25<05:55,  1.66s/it, v_num=0, train_loss=49.90]Epoch 0:  37%|███▋      | 125/338 [03:27<05:53,  1.66s/it, v_num=0, train_loss=49.90]Epoch 0:  37%|███▋      | 125/338 [03:27<05:53,  1.66s/it, v_num=0, train_loss=50.00]Epoch 0:  37%|███▋      | 126/338 [03:28<05:51,  1.66s/it, v_num=0, train_loss=50.00]Epoch 0:  37%|███▋      | 126/338 [03:28<05:51,  1.66s/it, v_num=0, train_loss=49.20]Epoch 0:  38%|███▊      | 127/338 [03:30<05:49,  1.66s/it, v_num=0, train_loss=49.20]Epoch 0:  38%|███▊      | 127/338 [03:30<05:49,  1.66s/it, v_num=0, train_loss=49.10]Epoch 0:  38%|███▊      | 128/338 [03:32<05:48,  1.66s/it, v_num=0, train_loss=49.10]Epoch 0:  38%|███▊      | 128/338 [03:32<05:48,  1.66s/it, v_num=0, train_loss=49.90]Epoch 0:  38%|███▊      | 129/338 [03:33<05:46,  1.66s/it, v_num=0, train_loss=49.90]Epoch 0:  38%|███▊      | 129/338 [03:33<05:46,  1.66s/it, v_num=0, train_loss=48.90]Epoch 0:  38%|███▊      | 130/338 [03:35<05:44,  1.66s/it, v_num=0, train_loss=48.90]Epoch 0:  38%|███▊      | 130/338 [03:35<05:44,  1.66s/it, v_num=0, train_loss=48.80]Epoch 0:  39%|███▉      | 131/338 [03:36<05:42,  1.66s/it, v_num=0, train_loss=48.80]Epoch 0:  39%|███▉      | 131/338 [03:36<05:42,  1.66s/it, v_num=0, train_loss=48.70]Epoch 0:  39%|███▉      | 132/338 [03:38<05:40,  1.65s/it, v_num=0, train_loss=48.70]Epoch 0:  39%|███▉      | 132/338 [03:38<05:40,  1.65s/it, v_num=0, train_loss=48.60]Epoch 0:  39%|███▉      | 133/338 [03:40<05:39,  1.65s/it, v_num=0, train_loss=48.60]Epoch 0:  39%|███▉      | 133/338 [03:40<05:39,  1.65s/it, v_num=0, train_loss=48.60]Epoch 0:  40%|███▉      | 134/338 [03:41<05:37,  1.65s/it, v_num=0, train_loss=48.60]Epoch 0:  40%|███▉      | 134/338 [03:41<05:37,  1.65s/it, v_num=0, train_loss=49.60]Epoch 0:  40%|███▉      | 135/338 [03:43<05:35,  1.65s/it, v_num=0, train_loss=49.60]Epoch 0:  40%|███▉      | 135/338 [03:43<05:35,  1.65s/it, v_num=0, train_loss=49.30]Epoch 0:  40%|████      | 136/338 [03:44<05:33,  1.65s/it, v_num=0, train_loss=49.30]Epoch 0:  40%|████      | 136/338 [03:44<05:33,  1.65s/it, v_num=0, train_loss=48.30]Epoch 0:  41%|████      | 137/338 [03:46<05:32,  1.65s/it, v_num=0, train_loss=48.30]Epoch 0:  41%|████      | 137/338 [03:46<05:32,  1.65s/it, v_num=0, train_loss=48.20]Epoch 0:  41%|████      | 138/338 [03:47<05:30,  1.65s/it, v_num=0, train_loss=48.20]Epoch 0:  41%|████      | 138/338 [03:47<05:30,  1.65s/it, v_num=0, train_loss=48.10]Epoch 0:  41%|████      | 139/338 [03:49<05:28,  1.65s/it, v_num=0, train_loss=48.10]Epoch 0:  41%|████      | 139/338 [03:49<05:28,  1.65s/it, v_num=0, train_loss=48.30]Epoch 0:  41%|████▏     | 140/338 [03:51<05:26,  1.65s/it, v_num=0, train_loss=48.30]Epoch 0:  41%|████▏     | 140/338 [03:51<05:26,  1.65s/it, v_num=0, train_loss=48.10]Epoch 0:  42%|████▏     | 141/338 [03:52<05:25,  1.65s/it, v_num=0, train_loss=48.10]Epoch 0:  42%|████▏     | 141/338 [03:52<05:25,  1.65s/it, v_num=0, train_loss=49.10]Epoch 0:  42%|████▏     | 142/338 [03:54<05:23,  1.65s/it, v_num=0, train_loss=49.10]Epoch 0:  42%|████▏     | 142/338 [03:54<05:23,  1.65s/it, v_num=0, train_loss=48.60]Epoch 0:  42%|████▏     | 143/338 [03:55<05:21,  1.65s/it, v_num=0, train_loss=48.60]Epoch 0:  42%|████▏     | 143/338 [03:55<05:21,  1.65s/it, v_num=0, train_loss=47.80]Epoch 0:  43%|████▎     | 144/338 [03:57<05:19,  1.65s/it, v_num=0, train_loss=47.80]Epoch 0:  43%|████▎     | 144/338 [03:57<05:19,  1.65s/it, v_num=0, train_loss=48.90]Epoch 0:  43%|████▎     | 145/338 [03:58<05:18,  1.65s/it, v_num=0, train_loss=48.90]Epoch 0:  43%|████▎     | 145/338 [03:58<05:18,  1.65s/it, v_num=0, train_loss=47.70]Epoch 0:  43%|████▎     | 146/338 [04:00<05:16,  1.65s/it, v_num=0, train_loss=47.70]Epoch 0:  43%|████▎     | 146/338 [04:00<05:16,  1.65s/it, v_num=0, train_loss=48.10]Epoch 0:  43%|████▎     | 147/338 [04:02<05:14,  1.65s/it, v_num=0, train_loss=48.10]Epoch 0:  43%|████▎     | 147/338 [04:02<05:14,  1.65s/it, v_num=0, train_loss=47.50]Epoch 0:  44%|████▍     | 148/338 [04:03<05:12,  1.65s/it, v_num=0, train_loss=47.50]Epoch 0:  44%|████▍     | 148/338 [04:03<05:12,  1.65s/it, v_num=0, train_loss=48.20]Epoch 0:  44%|████▍     | 149/338 [04:05<05:11,  1.65s/it, v_num=0, train_loss=48.20]Epoch 0:  44%|████▍     | 149/338 [04:05<05:11,  1.65s/it, v_num=0, train_loss=47.20]Epoch 0:  44%|████▍     | 150/338 [04:06<05:09,  1.65s/it, v_num=0, train_loss=47.20]Epoch 0:  44%|████▍     | 150/338 [04:06<05:09,  1.65s/it, v_num=0, train_loss=47.20]Epoch 0:  45%|████▍     | 151/338 [04:08<05:07,  1.65s/it, v_num=0, train_loss=47.20]Epoch 0:  45%|████▍     | 151/338 [04:08<05:07,  1.65s/it, v_num=0, train_loss=48.20]Epoch 0:  45%|████▍     | 152/338 [04:10<05:06,  1.65s/it, v_num=0, train_loss=48.20]Epoch 0:  45%|████▍     | 152/338 [04:10<05:06,  1.65s/it, v_num=0, train_loss=46.90]Epoch 0:  45%|████▌     | 153/338 [04:11<05:04,  1.64s/it, v_num=0, train_loss=46.90]Epoch 0:  45%|████▌     | 153/338 [04:11<05:04,  1.64s/it, v_num=0, train_loss=46.80]Epoch 0:  46%|████▌     | 154/338 [04:13<05:02,  1.64s/it, v_num=0, train_loss=46.80]Epoch 0:  46%|████▌     | 154/338 [04:13<05:02,  1.64s/it, v_num=0, train_loss=46.80]Epoch 0:  46%|████▌     | 155/338 [04:14<05:00,  1.64s/it, v_num=0, train_loss=46.80]Epoch 0:  46%|████▌     | 155/338 [04:14<05:00,  1.64s/it, v_num=0, train_loss=46.70]Epoch 0:  46%|████▌     | 156/338 [04:16<04:59,  1.64s/it, v_num=0, train_loss=46.70]Epoch 0:  46%|████▌     | 156/338 [04:16<04:59,  1.64s/it, v_num=0, train_loss=46.60]Epoch 0:  46%|████▋     | 157/338 [04:17<04:57,  1.64s/it, v_num=0, train_loss=46.60]Epoch 0:  46%|████▋     | 157/338 [04:17<04:57,  1.64s/it, v_num=0, train_loss=46.30]Epoch 0:  47%|████▋     | 158/338 [04:19<04:55,  1.64s/it, v_num=0, train_loss=46.30]Epoch 0:  47%|████▋     | 158/338 [04:19<04:55,  1.64s/it, v_num=0, train_loss=47.00]Epoch 0:  47%|████▋     | 159/338 [04:21<04:53,  1.64s/it, v_num=0, train_loss=47.00]Epoch 0:  47%|████▋     | 159/338 [04:21<04:53,  1.64s/it, v_num=0, train_loss=46.20]Epoch 0:  47%|████▋     | 160/338 [04:22<04:52,  1.64s/it, v_num=0, train_loss=46.20]Epoch 0:  47%|████▋     | 160/338 [04:22<04:52,  1.64s/it, v_num=0, train_loss=46.20]Epoch 0:  48%|████▊     | 161/338 [04:24<04:50,  1.64s/it, v_num=0, train_loss=46.20]Epoch 0:  48%|████▊     | 161/338 [04:24<04:50,  1.64s/it, v_num=0, train_loss=46.00]Epoch 0:  48%|████▊     | 162/338 [04:25<04:48,  1.64s/it, v_num=0, train_loss=46.00]Epoch 0:  48%|████▊     | 162/338 [04:25<04:48,  1.64s/it, v_num=0, train_loss=45.90]Epoch 0:  48%|████▊     | 163/338 [04:27<04:47,  1.64s/it, v_num=0, train_loss=45.90]Epoch 0:  48%|████▊     | 163/338 [04:27<04:47,  1.64s/it, v_num=0, train_loss=45.90]Epoch 0:  49%|████▊     | 164/338 [04:29<04:45,  1.64s/it, v_num=0, train_loss=45.90]Epoch 0:  49%|████▊     | 164/338 [04:29<04:45,  1.64s/it, v_num=0, train_loss=46.00]Epoch 0:  49%|████▉     | 165/338 [04:30<04:43,  1.64s/it, v_num=0, train_loss=46.00]Epoch 0:  49%|████▉     | 165/338 [04:30<04:43,  1.64s/it, v_num=0, train_loss=46.50]Epoch 0:  49%|████▉     | 166/338 [04:32<04:42,  1.64s/it, v_num=0, train_loss=46.50]Epoch 0:  49%|████▉     | 166/338 [04:32<04:42,  1.64s/it, v_num=0, train_loss=45.10]Epoch 0:  49%|████▉     | 167/338 [04:33<04:40,  1.64s/it, v_num=0, train_loss=45.10]Epoch 0:  49%|████▉     | 167/338 [04:33<04:40,  1.64s/it, v_num=0, train_loss=46.10]Epoch 0:  50%|████▉     | 168/338 [04:35<04:38,  1.64s/it, v_num=0, train_loss=46.10]Epoch 0:  50%|████▉     | 168/338 [04:35<04:38,  1.64s/it, v_num=0, train_loss=45.00]Epoch 0:  50%|█████     | 169/338 [04:37<04:37,  1.64s/it, v_num=0, train_loss=45.00]Epoch 0:  50%|█████     | 169/338 [04:37<04:37,  1.64s/it, v_num=0, train_loss=44.60]Epoch 0:  50%|█████     | 170/338 [04:38<04:35,  1.64s/it, v_num=0, train_loss=44.60]Epoch 0:  50%|█████     | 170/338 [04:38<04:35,  1.64s/it, v_num=0, train_loss=45.00]Epoch 0:  51%|█████     | 171/338 [04:40<04:33,  1.64s/it, v_num=0, train_loss=45.00]Epoch 0:  51%|█████     | 171/338 [04:40<04:33,  1.64s/it, v_num=0, train_loss=44.40]Epoch 0:  51%|█████     | 172/338 [04:41<04:31,  1.64s/it, v_num=0, train_loss=44.40]Epoch 0:  51%|█████     | 172/338 [04:41<04:31,  1.64s/it, v_num=0, train_loss=45.10]Epoch 0:  51%|█████     | 173/338 [04:43<04:30,  1.64s/it, v_num=0, train_loss=45.10]Epoch 0:  51%|█████     | 173/338 [04:43<04:30,  1.64s/it, v_num=0, train_loss=44.10]Epoch 0:  51%|█████▏    | 174/338 [04:44<04:28,  1.64s/it, v_num=0, train_loss=44.10]Epoch 0:  51%|█████▏    | 174/338 [04:44<04:28,  1.64s/it, v_num=0, train_loss=43.80]Epoch 0:  52%|█████▏    | 175/338 [04:46<04:26,  1.64s/it, v_num=0, train_loss=43.80]Epoch 0:  52%|█████▏    | 175/338 [04:46<04:26,  1.64s/it, v_num=0, train_loss=43.50]Epoch 0:  52%|█████▏    | 176/338 [04:48<04:25,  1.64s/it, v_num=0, train_loss=43.50]Epoch 0:  52%|█████▏    | 176/338 [04:48<04:25,  1.64s/it, v_num=0, train_loss=43.70]Epoch 0:  52%|█████▏    | 177/338 [04:49<04:23,  1.64s/it, v_num=0, train_loss=43.70]Epoch 0:  52%|█████▏    | 177/338 [04:49<04:23,  1.64s/it, v_num=0, train_loss=43.00]Epoch 0:  53%|█████▎    | 178/338 [04:51<04:21,  1.64s/it, v_num=0, train_loss=43.00]Epoch 0:  53%|█████▎    | 178/338 [04:51<04:21,  1.64s/it, v_num=0, train_loss=43.50]Epoch 0:  53%|█████▎    | 179/338 [04:52<04:20,  1.64s/it, v_num=0, train_loss=43.50]Epoch 0:  53%|█████▎    | 179/338 [04:52<04:20,  1.64s/it, v_num=0, train_loss=43.70]Epoch 0:  53%|█████▎    | 180/338 [04:54<04:18,  1.64s/it, v_num=0, train_loss=43.70]Epoch 0:  53%|█████▎    | 180/338 [04:54<04:18,  1.64s/it, v_num=0, train_loss=42.50]Epoch 0:  54%|█████▎    | 181/338 [04:56<04:16,  1.64s/it, v_num=0, train_loss=42.50]Epoch 0:  54%|█████▎    | 181/338 [04:56<04:16,  1.64s/it, v_num=0, train_loss=43.30]Epoch 0:  54%|█████▍    | 182/338 [04:57<04:15,  1.64s/it, v_num=0, train_loss=43.30]Epoch 0:  54%|█████▍    | 182/338 [04:57<04:15,  1.64s/it, v_num=0, train_loss=42.50]Epoch 0:  54%|█████▍    | 183/338 [04:59<04:13,  1.64s/it, v_num=0, train_loss=42.50]Epoch 0:  54%|█████▍    | 183/338 [04:59<04:13,  1.64s/it, v_num=0, train_loss=42.50]Epoch 0:  54%|█████▍    | 184/338 [05:00<04:11,  1.64s/it, v_num=0, train_loss=42.50]Epoch 0:  54%|█████▍    | 184/338 [05:00<04:11,  1.64s/it, v_num=0, train_loss=41.20]Epoch 0:  55%|█████▍    | 185/338 [05:02<04:10,  1.63s/it, v_num=0, train_loss=41.20]Epoch 0:  55%|█████▍    | 185/338 [05:02<04:10,  1.63s/it, v_num=0, train_loss=41.00]Epoch 0:  55%|█████▌    | 186/338 [05:04<04:08,  1.64s/it, v_num=0, train_loss=41.00]Epoch 0:  55%|█████▌    | 186/338 [05:04<04:08,  1.64s/it, v_num=0, train_loss=40.70]Epoch 0:  55%|█████▌    | 187/338 [05:05<04:06,  1.63s/it, v_num=0, train_loss=40.70]Epoch 0:  55%|█████▌    | 187/338 [05:05<04:06,  1.63s/it, v_num=0, train_loss=41.40]Epoch 0:  56%|█████▌    | 188/338 [05:07<04:05,  1.63s/it, v_num=0, train_loss=41.40]Epoch 0:  56%|█████▌    | 188/338 [05:07<04:05,  1.63s/it, v_num=0, train_loss=40.00]Epoch 0:  56%|█████▌    | 189/338 [05:08<04:03,  1.63s/it, v_num=0, train_loss=40.00]Epoch 0:  56%|█████▌    | 189/338 [05:08<04:03,  1.63s/it, v_num=0, train_loss=40.50]Epoch 0:  56%|█████▌    | 190/338 [05:10<04:01,  1.63s/it, v_num=0, train_loss=40.50]Epoch 0:  56%|█████▌    | 190/338 [05:10<04:01,  1.63s/it, v_num=0, train_loss=40.50]Epoch 0:  57%|█████▋    | 191/338 [05:11<04:00,  1.63s/it, v_num=0, train_loss=40.50]Epoch 0:  57%|█████▋    | 191/338 [05:11<04:00,  1.63s/it, v_num=0, train_loss=40.10]Epoch 0:  57%|█████▋    | 192/338 [05:13<03:58,  1.63s/it, v_num=0, train_loss=40.10]Epoch 0:  57%|█████▋    | 192/338 [05:13<03:58,  1.63s/it, v_num=0, train_loss=38.80]Epoch 0:  57%|█████▋    | 193/338 [05:15<03:56,  1.63s/it, v_num=0, train_loss=38.80]Epoch 0:  57%|█████▋    | 193/338 [05:15<03:56,  1.63s/it, v_num=0, train_loss=38.70]Epoch 0:  57%|█████▋    | 194/338 [05:16<03:55,  1.63s/it, v_num=0, train_loss=38.70]Epoch 0:  57%|█████▋    | 194/338 [05:16<03:55,  1.63s/it, v_num=0, train_loss=39.10]Epoch 0:  58%|█████▊    | 195/338 [05:18<03:53,  1.63s/it, v_num=0, train_loss=39.10]Epoch 0:  58%|█████▊    | 195/338 [05:18<03:53,  1.63s/it, v_num=0, train_loss=37.80]Epoch 0:  58%|█████▊    | 196/338 [05:19<03:51,  1.63s/it, v_num=0, train_loss=37.80]Epoch 0:  58%|█████▊    | 196/338 [05:19<03:51,  1.63s/it, v_num=0, train_loss=38.40]Epoch 0:  58%|█████▊    | 197/338 [05:21<03:50,  1.63s/it, v_num=0, train_loss=38.40]Epoch 0:  58%|█████▊    | 197/338 [05:21<03:50,  1.63s/it, v_num=0, train_loss=37.20]Epoch 0:  59%|█████▊    | 198/338 [05:23<03:48,  1.63s/it, v_num=0, train_loss=37.20]Epoch 0:  59%|█████▊    | 198/338 [05:23<03:48,  1.63s/it, v_num=0, train_loss=37.90]Epoch 0:  59%|█████▉    | 199/338 [05:24<03:46,  1.63s/it, v_num=0, train_loss=37.90]Epoch 0:  59%|█████▉    | 199/338 [05:24<03:46,  1.63s/it, v_num=0, train_loss=36.60]Epoch 0:  59%|█████▉    | 200/338 [05:26<03:45,  1.63s/it, v_num=0, train_loss=36.60]Epoch 0:  59%|█████▉    | 200/338 [05:26<03:45,  1.63s/it, v_num=0, train_loss=36.30]Epoch 0:  59%|█████▉    | 201/338 [05:27<03:43,  1.63s/it, v_num=0, train_loss=36.30]Epoch 0:  59%|█████▉    | 201/338 [05:27<03:43,  1.63s/it, v_num=0, train_loss=36.90]Epoch 0:  60%|█████▉    | 202/338 [05:29<03:41,  1.63s/it, v_num=0, train_loss=36.90]Epoch 0:  60%|█████▉    | 202/338 [05:29<03:41,  1.63s/it, v_num=0, train_loss=36.10]Epoch 0:  60%|██████    | 203/338 [05:31<03:40,  1.63s/it, v_num=0, train_loss=36.10]Epoch 0:  60%|██████    | 203/338 [05:31<03:40,  1.63s/it, v_num=0, train_loss=35.10]Epoch 0:  60%|██████    | 204/338 [05:32<03:38,  1.63s/it, v_num=0, train_loss=35.10]Epoch 0:  60%|██████    | 204/338 [05:32<03:38,  1.63s/it, v_num=0, train_loss=34.60]Epoch 0:  61%|██████    | 205/338 [05:34<03:36,  1.63s/it, v_num=0, train_loss=34.60]Epoch 0:  61%|██████    | 205/338 [05:34<03:36,  1.63s/it, v_num=0, train_loss=34.40]Epoch 0:  61%|██████    | 206/338 [05:35<03:35,  1.63s/it, v_num=0, train_loss=34.40]Epoch 0:  61%|██████    | 206/338 [05:35<03:35,  1.63s/it, v_num=0, train_loss=34.90]Epoch 0:  61%|██████    | 207/338 [05:37<03:33,  1.63s/it, v_num=0, train_loss=34.90]Epoch 0:  61%|██████    | 207/338 [05:37<03:33,  1.63s/it, v_num=0, train_loss=33.40]Epoch 0:  62%|██████▏   | 208/338 [05:38<03:31,  1.63s/it, v_num=0, train_loss=33.40]Epoch 0:  62%|██████▏   | 208/338 [05:38<03:31,  1.63s/it, v_num=0, train_loss=33.00]Epoch 0:  62%|██████▏   | 209/338 [05:40<03:30,  1.63s/it, v_num=0, train_loss=33.00]Epoch 0:  62%|██████▏   | 209/338 [05:40<03:30,  1.63s/it, v_num=0, train_loss=33.40]Epoch 0:  62%|██████▏   | 210/338 [05:42<03:28,  1.63s/it, v_num=0, train_loss=33.40]Epoch 0:  62%|██████▏   | 210/338 [05:42<03:28,  1.63s/it, v_num=0, train_loss=32.40]Epoch 0:  62%|██████▏   | 211/338 [05:43<03:26,  1.63s/it, v_num=0, train_loss=32.40]Epoch 0:  62%|██████▏   | 211/338 [05:43<03:26,  1.63s/it, v_num=0, train_loss=31.80]Epoch 0:  63%|██████▎   | 212/338 [05:45<03:25,  1.63s/it, v_num=0, train_loss=31.80]Epoch 0:  63%|██████▎   | 212/338 [05:45<03:25,  1.63s/it, v_num=0, train_loss=31.50]Epoch 0:  63%|██████▎   | 213/338 [05:46<03:23,  1.63s/it, v_num=0, train_loss=31.50]Epoch 0:  63%|██████▎   | 213/338 [05:46<03:23,  1.63s/it, v_num=0, train_loss=32.30]Epoch 0:  63%|██████▎   | 214/338 [05:48<03:21,  1.63s/it, v_num=0, train_loss=32.30]Epoch 0:  63%|██████▎   | 214/338 [05:48<03:21,  1.63s/it, v_num=0, train_loss=31.70]Epoch 0:  64%|██████▎   | 215/338 [05:50<03:20,  1.63s/it, v_num=0, train_loss=31.70]Epoch 0:  64%|██████▎   | 215/338 [05:50<03:20,  1.63s/it, v_num=0, train_loss=31.40]Epoch 0:  64%|██████▍   | 216/338 [05:51<03:18,  1.63s/it, v_num=0, train_loss=31.40]Epoch 0:  64%|██████▍   | 216/338 [05:51<03:18,  1.63s/it, v_num=0, train_loss=30.10]Epoch 0:  64%|██████▍   | 217/338 [05:53<03:16,  1.63s/it, v_num=0, train_loss=30.10]Epoch 0:  64%|██████▍   | 217/338 [05:53<03:16,  1.63s/it, v_num=0, train_loss=30.60]Epoch 0:  64%|██████▍   | 218/338 [05:54<03:15,  1.63s/it, v_num=0, train_loss=30.60]Epoch 0:  64%|██████▍   | 218/338 [05:54<03:15,  1.63s/it, v_num=0, train_loss=29.90]Epoch 0:  65%|██████▍   | 219/338 [05:56<03:13,  1.63s/it, v_num=0, train_loss=29.90]Epoch 0:  65%|██████▍   | 219/338 [05:56<03:13,  1.63s/it, v_num=0, train_loss=29.60]Epoch 0:  65%|██████▌   | 220/338 [05:57<03:11,  1.63s/it, v_num=0, train_loss=29.60]Epoch 0:  65%|██████▌   | 220/338 [05:57<03:11,  1.63s/it, v_num=0, train_loss=29.50]Epoch 0:  65%|██████▌   | 221/338 [05:59<03:10,  1.63s/it, v_num=0, train_loss=29.50]Epoch 0:  65%|██████▌   | 221/338 [05:59<03:10,  1.63s/it, v_num=0, train_loss=28.00]Epoch 0:  66%|██████▌   | 222/338 [06:01<03:08,  1.63s/it, v_num=0, train_loss=28.00]Epoch 0:  66%|██████▌   | 222/338 [06:01<03:08,  1.63s/it, v_num=0, train_loss=28.00]Epoch 0:  66%|██████▌   | 223/338 [06:02<03:06,  1.63s/it, v_num=0, train_loss=28.00]Epoch 0:  66%|██████▌   | 223/338 [06:02<03:06,  1.63s/it, v_num=0, train_loss=28.40]Traceback (most recent call last):
  File "/pfs/data5/home/ma/ma_ma/ma_dsperber/CropAndWeedDetection/train.py", line 297, in <module>
    train()
  File "/pfs/data5/home/ma/ma_ma/ma_dsperber/CropAndWeedDetection/train.py", line 284, in train
    pprint(trainer.fit(pl_model, data))
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 42, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 92, in launch
    return function(*args, **kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 978, in _run_stage
    self.fit_loop.run()
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 218, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 185, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 261, in _optimizer_step
    call._call_lightning_module_hook(
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 142, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/core/module.py", line 1265, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/core/optimizer.py", line 158, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/strategies/ddp.py", line 257, in optimizer_step
    optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 224, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/pytorch_lightning/plugins/precision/deepspeed.py", line 102, in optimizer_step
    return deepspeed_engine.step(**kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/deepspeed/runtime/engine.py", line 2184, in step
    self._take_model_step(lr_kwargs)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/deepspeed/runtime/engine.py", line 2086, in _take_model_step
    self.optimizer.step()
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1778, in step
    self._update_scale(self.overflow)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 2028, in _update_scale
    self.loss_scaler.update_scale(has_overflow)
  File "/pfs/work7/workspace/scratch/ma_dsperber-industry/cropandweed-dataset/workenv/lib64/python3.9/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 164, in update_scale
    raise Exception(
Exception: Current loss scale already at minimum - cannot decrease scale anymore. Exiting run.

============================= JOB FEEDBACK =============================

NodeName=uc2n509
Job ID: 21991327
Cluster: uc2
User/Group: ma_dsperber/ma_ma
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 20
CPU Utilized: 00:37:13
CPU Efficiency: 20.75% of 02:59:20 core-walltime
Job Wall-clock time: 00:08:58
Memory Utilized: 181.09 GB
Memory Efficiency: 72.44% of 250.00 GB
